---
title: "NYC_DATA605_FINAL_PROJECT"
author: "Youssef Abdelwahab"
date: "`r Sys.Date()`"
output: pdf_document
---



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}
library(ggplot2)
library(boot)
library(dplyr)



```


```{r}
nyc_dataset = read.csv("NYPD_Shooting_Incident_Data__Historic__20250130.csv")
nyc_dataset_cleaned = nyc_dataset[, !(names(nyc_dataset) %in% c("LOC_CLASSFCTN_DESC", "LOC_OF_OCCUR_DESC", "LOCATION_DESC"))]
```



```{r}
colnames(nyc_dataset_cleaned)
```

```{r}
black_victim_count <- sum(nyc_dataset$VIC_RACE == "BLACK", na.rm = TRUE)
print(black_victim_count)

```


```{r}

ggplot(nyc_dataset[nyc_dataset$VIC_RACE == "BLACK", ], aes(x = VIC_AGE_GROUP)) +
  geom_bar(fill = "lightblue") +
  labs(title = "Distribution of Black Victims by Age Group",
       x = "Age Group",
       y = "Count of Victims") +
  theme_minimal()

```

# Question 1: Victim Proportion Estimate of Victims of Race Black


```{r}
prop.table(table(nyc_dataset$AGE_GROUP[nyc_dataset$VIC_RACE == "BLACK"]))
total_victims <- nrow(nyc_dataset)


black_victims <- sum(nyc_dataset$VIC_RACE == "BLACK", na.rm = TRUE)


obs_proportion <- black_victims / total_victims
print(obs_proportion)

```

```{r}
set.seed(123)  


bootstrap_proportion_srs <- function(data, indices) {
  sampled_data <- data[sample(nrow(data), 5000 , replace = TRUE), ]  
  mean(sampled_data$VIC_RACE == "BLACK", na.rm = TRUE)  
}

boot_results_srs_black_victim <- boot(data = nyc_dataset_cleaned, statistic = bootstrap_proportion_srs, R = 1000)

obs_proportion <- mean(nyc_dataset_cleaned$VIC_RACE == "BLACK", na.rm = TRUE)
cat("Observed Proportion of Black Victims:", obs_proportion, "\n")
print(boot_results_srs_black_victim)


```

```{r}
boot_ci_srs_black_victim <- boot.ci(boot_results_srs_black_victim, type = "perc")


print(boot_ci_srs_black_victim)
```


```{r}
hist(boot_results_srs_black_victim$t, main = "Bootstrap Distribution of Black Victims Proportion",
     xlab = "Proportion of Black Victims", col = "lightblue", border = "black",
     breaks = 30, probability = TRUE)


abline(v = obs_proportion, col = "red", lwd = 2, lty = 2)


lines(density(boot_results_srs_black_victim$t), col = "blue", lwd = 2)
```


The histogram shows that the proportion of Black victims in shootings consistently falls between ~69% and ~73% across bootstrap samples. This suggests that the high proportion of Black victims in NYC shootings is not due to random sampling variation but is a persistent trend in the data. The proportion is highly stable, implying that this finding is not sensitive to sampling fluctuations. The fact that the proportion of Black victims remains high across bootstrap samples raises important sociological, economic, and policing concerns. The observed proportion (~70.8%), indicated by the red dashed line, is near the peak of the distribution, confirming that it aligns with what we would expect based on repeated re sampling.






# Question 2: Proportions of Murders and The Difference In proportions between non-murder incidents and murder incidents


```{r warning=FALSE}
set.seed(123)  

nyc_dataset_cleaned$MURDER_FLAG <- ifelse(nyc_dataset$STATISTICAL_MURDER_FLAG == "true", 1, 0)

obs_proportion_murder <- mean(nyc_dataset_cleaned$MURDER_FLAG, na.rm = TRUE)
print(obs_proportion_murder)

bootstrap_proportion_murder <- function(data, indices) {
  sampled_data <- data[sample(nrow(data), 5000 , replace=TRUE), ]  
  mean(sampled_data$MURDER_FLAG, na.rm = TRUE)  
}


boot_results_murder <- boot(data = nyc_dataset_cleaned, statistic = bootstrap_proportion_murder, R = 1000)

```

```{r}
boot_ci_murder <- boot.ci(boot_results_murder, type = "perc")


print(boot_ci_murder)

```


```{r}

hist(boot_results_murder$t, main = "Bootstrap Distribution of Sample Murders Proportion",
     xlab = "Proportion of Shootings Resulting in Murder",
     col = "lightblue", border = "black", breaks = 30, probability = TRUE)

abline(v = obs_proportion_murder, col = "red", lwd = 2, lty = 2)


lines(density(boot_results_murder$t), col = "blue", lwd = 2)


```




```{r}
set.seed(123)  


nyc_dataset_cleaned$MURDER_FLAG <- ifelse(nyc_dataset_cleaned$STATISTICAL_MURDER_FLAG == "true", 1, 0)


total_shootings <- nrow(nyc_dataset_cleaned)


prop_murder <- mean(nyc_dataset_cleaned$MURDER_FLAG == 1, na.rm = TRUE)


prop_non_murder <- mean(nyc_dataset_cleaned$MURDER_FLAG == 0, na.rm = TRUE)


cat("Proportion of Shootings with Murder:", prop_murder, "\n")
cat("Proportion of Shootings without Murder:", prop_non_murder, "\n")

```

```{r}

obs_diff <-  prop_non_murder - prop_murder 
cat("Observed Difference in Proportions:", obs_diff, "\n")

```
```{r}
set.seed(123)  


bootstrap_diff_murder <- function(data, indices) {
  sampled_data <- data[sample(nrow(data), 5000 , replace = TRUE), ]  
  prop_murder_boot <- mean(sampled_data$MURDER_FLAG == 1, na.rm = TRUE)
  prop_non_murder_boot <- mean(sampled_data$MURDER_FLAG == 0, na.rm = TRUE)
  return(prop_non_murder_boot - prop_murder_boot)  
}


boot_results_diff <- boot(data = nyc_dataset_cleaned, statistic = bootstrap_diff_murder, R = 1000)

```

```{r}
boot_ci_diff <- boot.ci(boot_results_diff, type = "perc")


print(boot_ci_diff)

```

```{r}

hist(boot_results_diff$t, main = "Bootstrap Distribution of Difference in Proportions",
     xlab = "Difference in Proportion (Murder vs. Non-Murder)", col = "lightblue", border = "black",
     breaks = 30, probability = TRUE)


abline(v = obs_diff, col = "red", lwd = 2, lty = 2)


lines(density(boot_results_diff$t), col = "blue", lwd = 2)

```
The goal is to assess whether the proportion of one category (e.g., shootings resulting in murder) is significantly different from the other. The histogram and the blue density curve indicate that the distribution of the difference in proportions is bell-shaped and symmetric, suggesting that the sampling distribution of the proportion difference follows a normal-like shape.

This validates the assumption that the bootstrap sampling distribution can be used to construct confidence intervals.

The confidence interval also does not include 0, meaning that the proportion of murders among shootings is consistently different from the proportion of non-murders and statistically signficant.
This suggests that certain factors may increase the likelihood of a shooting being fatal, such as:

- Firearm type used.
- Proximity of emergency medical services.
- Gang-related shootings vs. random acts of violence.



